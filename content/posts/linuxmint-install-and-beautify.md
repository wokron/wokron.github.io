+++
title = "Linux-Mint双系统的安装及美化"
tags = ["Linux", "Mint"]
categories = ["操作系统"]
aliases = ["/posts/10a01cda"]
date = "2023-06-24T21:50:32+08:00"
+++
## 一、前言
我的笔记本现在用起来很慢了。每次听到它嗡嗡的风扇声却又看不到它跑不出来结果的时候，就感觉它好似一头老驴，使劲却又力不从心，腿打着颤却也拉不动身后的货。所以我谋划着新买一台，就让之前的那台好好休息吧。

<!-- more -->

一想到买台新的笔记本，我的思绪就沿着这条道一直走下去：“要买什么样的配置呢？买了新的电脑要做些什么项目呢？要玩什么游戏呢？” 诸如此类。装一个 linux 系统也是这时产生的想法。有人可能会想，“这有什么用呢？难道 windows 就不能用吗？如果不得不用 linux，wsl 也是很好地办法，或者用虚拟机，甚至直接用 docker，都可以解决。” 确实，如果就满足当下的使用而言，将 linux 作为一个个人使用的真正的系统，相对于 windows 似乎并没有什么优点。

不过呢，我选择折腾这么一阵也并没有什么经过考量的理由，而仅仅是因为自己在主观上更加喜欢 linux 罢了。在我不算太长的接触并学习 linux 的时间里，我从这个系统中感受到了设计的一致性，这是我在更长时间的对 windows 的接触和学习中所没有体会到的。当然，或许在之后看来，我现在的理解也不过是浅薄的认识罢了。但是现在，我还是决定安装一个 linux 系统。

如果有读者的话，希望不要嫌弃我太过啰嗦（笑）。

## 二、为什么是薄荷
众所周知，linux 是内核，许多不同的组织在 linux 内核的基础上增加了其他必要的软件和应用，开发了不同的发行版。发行版的江湖中帮派林立，主要有三大派系，debian 系、redhat 系和 suse 系。各个派系中又有无数相互关联却又相互区分的发行版。如 debian 的 ubuntu、deepin；redhat 的 fedora、suse 的 opensuse。只需要把这些发行版的大名亮出来，就足以让人眼花缭乱了。

![complex-of-linux](complex-of-linux.jpg)

本人也在这些发行版中漂移不定了一段时间，但最终选择了 debian 系的 mint（薄荷）。主要有一下几个原因
- debian 系有着 apt 的超级牛力加持，.deb 格式的软件包使用作为广泛
- mint 基于 ubuntu，ubuntu 是使用最为广泛的 linux 发行版
- mint 精简了 ubuntu 下的一些功能，如 snap；并对初学者较为友好

## 三、安装操作系统
我新买的电脑是联想拯救者 R9000P，配置如下
|设备|配置|
|---|---|
|处理器|AMD Ryzen 9 7945HX|
|内存| 16G|
|硬盘| 1T|
|显卡| Nvidia 4060 |

要安装的操作系统配置
|名称|版本|
|---|---|
|操作系统|Linux Mint 21.1 Cinnamon|
|Cinnamon 版本|5.6.8|
|Linux 内核|5.15.0-75-generic|

接下开始安装。

### （1）windows 分盘
如果电脑中只有一个系统，那么当然就是这个系统占用所有的磁盘空间了。但是对于双系统，就需要将不同系统所使用的磁盘空间分离开来。

![disk1](disk1.png)

这里直接使用 windows 自带的磁盘管理工具进行分盘。可以在搜索栏里搜索 “磁盘分区” 并点击 “创建并格式化磁盘分区”。

![disk2](disk2.png)

之后在想要分盘的磁盘空间处点击右键，选择压缩卷。随后修改“输入压缩空间量”部分的数值，将其设定为你想要分配给另一个操作系统的磁盘空间大小。点击压缩。

![disk3](disk3.png)

此时应该会出现一块未分配的磁盘空间。这就是将来我们要将 linux 操作系统挂载到的位置。当然此处我已经为 linux 系统分配了 200g 的空间，并已经成功安装了。

### （2）usb 启动盘的制作
接下来我们要将一个 u 盘做成 linux 系统的启动盘。首先我们要去 [linux mint 官网](https://linuxmint.com/)下载 mint 发行版的光盘镜像。

这里本人选择下来 Cinnamon 版。除此之外 mint 还提供了 MATE 和 Xfce 版。Cinnamon、MATE 和 Xfce 是不同的 linux 桌面环境，与 windows 统一的桌面（explorer.exe）不同，linux 中提供了多种多样的桌面环境。对于 mint 来说，Cinnamon 是其自身开发的桌面环境，因此我便选择该桌面了。

Cinnamon 版的[下载页](https://linuxmint.com/edition.php?id=302)中提供了不同的镜像源，可以选择清华源进行[下载](https://mirrors.tuna.tsinghua.edu.cn/linuxmint-cd/stable/21.1/linuxmint-21.1-cinnamon-64bit.iso)。

为了将该镜像装入 u 盘中，还需要下载 usb 启动盘制作工具。这里使用 Universal USB Installer（2.0.1.5）。可以在此[下载页](https://www.pendrivelinux.com/universal-usb-installer-easy-as-1-2-3/)下载，或者直接点击[此处](https://www.pendrivelinux.com/downloads/Universal-USB-Installer/Universal-USB-Installer-2.0.1.5.exe)。

> 在继续之前需要强调一点，就是制作启动盘时，u 盘会被格式化，其中原有的数据都会被删除，因此请在制作之前做好 u 盘数据的备份。

下载完 Universal USB Installer 后直接双击打开即可。随后选择发行版、镜像位置以及要制作成启动盘的 u 盘。点击 Create 按钮进行制作。此过程可能需要几分钟。

![usb](usb.png)

完成之后，u 盘就变成了 linux 系统的启动盘。现在将电脑关机，接下来就要开始真正的系统安装。

### （3）安装 linux 系统
> 此节的部分图片引用自 [如何安装 Linux Mint 21 桌面版，详细步骤](https://www.sysgeek.cn/install-linux-mint-21/)

把 usb 启动盘插到要安装的电脑上，开机，并进入 boot menu。进入的方法可能因为笔记本的型号不同而有所差别，但对于 R9000P 来说，方法是在开机但还未启动的时候按 F12 键（为了避免错过可以不断按 F12 直到成功进入）。在 boot menu 中可以选择启动方式。这里需要选择带有 linpus lite 的启动选项（上下方向键选择、回车键确认）。之后就进入了一个 linux mint 的桌面环境。

但是目前的这个 linux mint 依旧在 u 盘上，需要双击桌面上的 Install Linux Mint 将系统安装到磁盘上。

![install](install1.jpg)

在安装界面，首先选择语言、键盘布局等，这些当然都选择 Chinese 即可。之后也需要安装多媒体编码译码器。

随后选择安装类型。因为要安装双系统，所以不能选 “清除整个磁盘并安装 Linux Mint” 选项，而要选择 “其它选项”。

![instal2](install2.jpg)

接着要选择操作系统要安装到的分区，这个分区我们已经在 windows 中划分出来了。右键点击该分区，选择 Ext4 日志文件系统，挂载点为根目录 `/`。继续。

![install](install3.jpg)

然后设置位置，当然是自行选择了。该位置会影响时区。

最后创建用户账户，也是自行填写即可。点击继续后就会开始 linux mint 系统的安装。安装完成后重启，并在 crub 系统选择界面选择 linux mint 进入即可。

### （4）踩坑和解决
这一部分记录了我在安装时踩得坑，或许比较幸运，并没有花费太长的时间解决。

#### 成功安装但无法启动
接着上一节，重启之后你可能会发现新安装的系统无法启动。显示的错误提示类似于如下内容
```text
error: bad shim signature
error: you need to load the kernel first
```

或是
```text
错误：无效的 shim 签名。
错误：您需要先加载内核。
```

这是由于 UEFI 开启了 secure boot 导致的。secure boot 要求在其上运行的系统必须具有正确的 shim 签名，否则无法运行。对于预装的 windows 系统来说，当然内置了 shim 签名；但是自行安装的系统，尤其是作为自由软件的 linux，就不太能提供正确的签名了。这一行为虽然确实能在一定程度上保护硬件的安全，但却更是被微软作为保持其 windows 系统垄断地位的手段。secure boot 模式可以在 bios 中选择是否启用。此前似乎也存在一旦关闭 secure boot 则无法再次启用的情况，不过厂商最终还是做出了让步。

要禁用 secure boot，首先需要关机再重新开机，在系统启动之前进入 bios，对于 R9000P 来说就是按 F2 键。不同厂商的 bios 外观不同，因此无法统一说明。但是只要找到 secure boot 相关的选项，并禁用该选项即可。应用修改后重新尝试进入 linux 系统。

#### 休眠后黑屏无法唤醒
合上笔记本的盖子，或者长时间不使用笔记本，笔记本就会进入休眠状态。此时采取按键等手段在正常情况下应该能唤醒笔记本。但是本人的笔记本在 linux 系统下会保持黑屏，但是电源灯、键盘灯、鼠标灯均表明系统已经被唤醒。

很明显，这是显示的问题。原因其实是 linux mint 系统在安装时默认采用 Nvidia 显卡的开源驱动 Nouveau，该驱动并没有得到 Nvidia 的认可与支持，只是让用户安装完系统即可进入桌面罢了。

所以还需要更换显卡的驱动，linux mint 提供了很方便的更换手段。其实在一开始进入 linux mint 时的欢迎页上，就有更换驱动的选项，可惜我那时并没有更新。不过就算错过了，只要在搜索栏里搜索 driver 并选择驱动管理器选项也可以更换显卡驱动。

只需要将原本开源的驱动改为 linux mint 标识了 “推荐” 的驱动即可，注意需要重启。之后再让笔记本进入休眠状态并唤醒，就不会出现黑屏了。

## 四、系统的美化
系统装是装上了，可总感觉有些朴素，长得也和 windows 没有什么区别。其实 linux 桌面的精髓是定制化。美化也是其中很重要的一部分。这一部分当然不是为了让读者做出和我一样的桌面，而只是记录一些可以用于美化的手段，也便于自己日后的使用。

### （1）主题配置
在搜索框中输入 theme 找到 “主题” 功能，可以用来修改桌面的整体外貌。可以在其中的 “添加/删除” 直接下载配置好的主题并应用；或者可以在如下的资源网站中搜索主题并下载。
- https://www.cinnamon-look.org/
- https://www.pling.com/

下载后，将其中的内容放到用户 home 目录下的隐藏文件夹中即可。比如对于图标，放入 .icons 中；对于主题，放入 .themes 文件夹中。

### （2）桌面小程序
右击面板可以为面板添加不同的小程序。这里可以列出我所使用的一些小程序
- Cinnamenu
- Corner bar
- XApp 状态小应用
- 日历
- 窗口列表
- ...

### （3）桌面布局
mint 可以修改桌面的布局。比如右击面板，点击移动可以将面板移动到桌面的上面。另外右键面板后也可以启用面板编辑模式，从而按照自己的需要排布分布在面板上的不同小程序的位置。

### （4）plank
plank 提供了一个轻量简洁的面板，可以直接通过 apt 下载
```sh
sudo apt-get install plank
```

下载完成后在搜索栏中搜索 plank 并点击打开，就可以看到桌面底端出现了一个面板。我们可以将该程序添加到开机启动项中。只需要在搜索栏中搜索 setting，点击系统设置；在系统设置中搜索 “开机自启动程序”，并将 plank 添加到其中即可。这样就得到了一个看上去更加美观的面板了。

### （5）grub 的美化
每次开机选择系统时都会进入 gnu grub 界面。可是这个界面实在是显得有些古老了。其实 grub 也是可以美化的。比如我们可以在[这个网站](https://www.gnome-look.org/browse?cat=109&ord=plinged)找到 grub 美化的主题。

选择喜欢的主题后下载，解压后直接运行其中的 install.sh 脚本即可。